(this["webpackJsonpeta-react"]=this["webpackJsonpeta-react"]||[]).push([[0],{42:function(t,e,n){},65:function(t,e,n){"use strict";n.r(e);n(16);var a=n(12),r=n(15),o=n(13),s=n(22),i=n(21),c=n(0),l=n.n(c),u=n(11),p=n.n(u),d=(n(42),n(29)),h=n(105),b=n(106),f=n(107),j=n(6),g=(l.a.Component,function(t){Object(s.a)(n,t);var e=Object(i.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).state={etas:[]},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=function(){fetch(t.props.track.url).then((function(t){return t.json()})).then((function(e){var n=e.data,a=[],r=Date.now();n.forEach((function(e){if(e.dir===t.props.track.bound){var n=Math.round((new Date(e.eta)-r)/1e3/60);n>=0&&a.push(n)}})),0===a.length&&a.push("no car"),t.setState({etas:a})}))};e(),setInterval((function(){e()}),1e4)}},{key:"render",value:function(){var t=this;return Object(j.jsxs)("div",{onContextMenu:function(){t.props.removeTrack(t.props.track.url)},style:{fontSize:"10px",marginBottom:"10px",borderRadius:"12px",aspectRatio:"4/1",width:"100%",maxWidth:"12cm",backgroundColor:"lightsteelblue",display:"flex",flexDirection:"row"},children:[" ",Object(j.jsx)("div",{style:{width:"20%",margin:"2.5%",backgroundColor:"lightgray",borderRadius:"50%",aspectRatio:"1/1",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(j.jsx)("div",{style:{padding:"10%",fontSize:"1.5em",aspectRatio:"1/1"},children:this.props.track.route})}),Object(j.jsxs)("div",{style:{width:"75%",aspectRatio:"3/1"},children:[Object(j.jsx)("div",{style:{aspectRatio:"6/1",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(j.jsx)("div",{style:{fontSize:"1.3em"},children:this.props.track.orig+" -> "+this.props.track.dest})}),Object(j.jsxs)("div",{style:{aspectRatio:"6/1",display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"space-around"},children:[Object(j.jsx)("div",{style:{fontSize:"1.5em"},children:this.props.track.stop}),Object(j.jsx)("div",{style:{width:"30%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:this.state.etas.map((function(t,e){return Object(j.jsx)("div",{style:{backgroundColor:"lightblue",padding:"2.5px 5px",borderRadius:"7.5px"},children:t},e)}))})]})]})]})}}]),n}(l.a.Component)),m=(l.a.Component,n(37),n(64),function(t){Object(s.a)(n,t);var e=Object(i.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).state={routes:null,stops:null,mappings:null,tracks:null,debug:"init"},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=function(e,n){var r=window.localStorage,o=r.getItem("eta-react-"+e);if(o)console.log("load "+e+" from localStorage"),t.setState(Object(a.a)({},e,JSON.parse(o)));else if(n)console.log("load "+e+" from internet"),function(t){return fetch(t).then((function(t){return t.json()}))}(n).then((function(n){var o=n.data,s={};"routes"===e&&o.forEach((function(t){s[t.route+"&"+t.bound]=t})),"stops"===e&&o.forEach((function(t){s[t.stop]=t})),"mappings"===e&&o.forEach((function(t){s[t.route+"&"+t.bound]||(s[t.route+"&"+t.bound]=[]),s[t.route+"&"+t.bound].push(t)})),r.setItem("eta-react-"+e,JSON.stringify(s)),t.setState(Object(a.a)({},e,s))}));else{console.log("store empty "+e+" to localStorage");var s=[];t.setState(Object(a.a)({},e,s)),r.setItem("eta-react-"+e,JSON.stringify(s))}};e("routes","https://data.etabus.gov.hk/v1/transport/kmb/route/"),e("stops","https://data.etabus.gov.hk/v1/transport/kmb/stop"),e("mappings","https://data.etabus.gov.hk/v1/transport/kmb/route-stop"),e("tracks",null)}},{key:"render",value:function(){var t=this;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("pre",{children:this.state.debug}),Object(j.jsx)("input",{type:"text"}),Object(j.jsx)("code",{children:" Right click card to remove "}),Object(j.jsx)("br",{}),Object(j.jsx)("code",{children:" Refresh rate: 10s"}),Object(j.jsx)("button",{onClick:function(){var e=JSON.parse(window.localStorage.getItem("eta-react-routes"))["968&I"],n=JSON.parse(window.localStorage.getItem("eta-react-stops")).B7773ED8D2FC08E5,a=JSON.parse(window.localStorage.getItem("eta-react-mappings"))["968&I"];t.setState({debug:JSON.stringify(e)+"\n"+JSON.stringify(n)+"\n"+JSON.stringify(a[0])})},children:"abc"})]})}}]),n}(l.a.Component));p.a.render(Object(j.jsx)(m,{}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.0e220ad1.chunk.js.map