(this["webpackJsonpeta-react"]=this["webpackJsonpeta-react"]||[]).push([[0],{42:function(t,e,n){},65:function(t,e,n){"use strict";n.r(e);n(16);var o=n(12),r=n(15),s=n(13),a=n(22),i=n(21),c=n(0),l=n.n(c),u=n(11),d=n.n(u),p=(n(42),n(29)),h=n(105),f=n(106),b=n(107),j=n(7),g=(l.a.Component,function(t){Object(a.a)(n,t);var e=Object(i.a)(n);function n(t){var o;return Object(r.a)(this,n),(o=e.call(this,t)).state={etas:[]},o}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=function(){fetch(t.props.track.url).then((function(t){return t.json()})).then((function(e){var n=e.data,o=[],r=Date.now();n.forEach((function(e){if(e.dir===t.props.track.bound){var n=Math.round((new Date(e.eta)-r)/1e3/60);n>=0&&o.push(n)}})),0===o.length&&o.push("no car"),t.setState({etas:o})}))};e(),setInterval((function(){e()}),1e4)}},{key:"render",value:function(){var t=this;return Object(j.jsxs)("div",{onContextMenu:function(){t.props.removeTrack(t.props.track.url)},style:{fontSize:"10px",marginBottom:"10px",borderRadius:"12px",aspectRatio:"4/1",width:"100%",maxWidth:"12cm",backgroundColor:"lightsteelblue",display:"flex",flexDirection:"row"},children:[" ",Object(j.jsx)("div",{style:{width:"20%",margin:"2.5%",backgroundColor:"lightgray",borderRadius:"50%",aspectRatio:"1/1",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(j.jsx)("div",{style:{padding:"10%",fontSize:"1.5em",aspectRatio:"1/1"},children:this.props.track.route})}),Object(j.jsxs)("div",{style:{width:"75%",aspectRatio:"3/1"},children:[Object(j.jsx)("div",{style:{aspectRatio:"6/1",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(j.jsx)("div",{style:{fontSize:"1.3em"},children:this.props.track.orig+" -> "+this.props.track.dest})}),Object(j.jsxs)("div",{style:{aspectRatio:"6/1",display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"space-around"},children:[Object(j.jsx)("div",{style:{fontSize:"1.5em"},children:this.props.track.stop}),Object(j.jsx)("div",{style:{width:"30%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:this.state.etas.map((function(t,e){return Object(j.jsx)("div",{style:{backgroundColor:"lightblue",padding:"2.5px 5px",borderRadius:"7.5px"},children:t},e)}))})]})]})]})}}]),n}(l.a.Component)),m=(l.a.Component,n(37),n(64),function(t){Object(a.a)(n,t);var e=Object(i.a)(n);function n(t){var o;return Object(r.a)(this,n),(o=e.call(this,t)).state={routes:null,stops:null,mappings:null,tracks:null,debug:"init"},o}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=function(e,n){var r=window.localStorage,s=r.getItem(e);if(s)console.log("load "+e+" from localStorage"),t.setState(Object(o.a)({},e,JSON.parse(s)));else if(n)console.log("load "+e+" from internet"),function(t){return fetch(t).then((function(t){return t.json()}))}(n).then((function(n){var s=n.data,a={};"routes"===e&&s.forEach((function(t){a[t.route+"&"+t.bound]=t})),"stops"===e&&s.forEach((function(t){a[t.stop]=t})),"mappings"===e&&s.forEach((function(t){a[t.route+"&"+t.bound]||(a[t.route+"&"+t.bound]=[]),a[t.route+"&"+t.bound].push(t)})),r.setItem(e,JSON.stringify(a)),t.setState(Object(o.a)({},e,a))}));else{console.log("store empty "+e+" to localStorage");var a=[];t.setState(Object(o.a)({},e,a)),r.setItem(e,JSON.stringify(a))}};e("routes","https://data.etabus.gov.hk/v1/transport/kmb/route/"),e("stops","https://data.etabus.gov.hk/v1/transport/kmb/stop"),e("mappings","https://data.etabus.gov.hk/v1/transport/kmb/route-stop"),e("tracks",null)}},{key:"render",value:function(){var t=this;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("pre",{children:this.state.debug}),Object(j.jsx)("code",{children:" Right click card to remove "}),Object(j.jsx)("br",{}),Object(j.jsx)("code",{children:" Refresh rate: 10s"}),Object(j.jsx)("button",{onClick:function(){var e=JSON.parse(window.localStorage.getItem("routes"))["968&I"],n=JSON.parse(window.localStorage.getItem("stops")).B7773ED8D2FC08E5,o=JSON.parse(window.localStorage.getItem("mappings"))["968&I"];console.log(n),t.setState({debug:JSON.stringify(e)+"\n"+JSON.stringify(n)+"\n"+JSON.stringify(o[0])})},children:"a"})]})}}]),n}(l.a.Component));d.a.render(Object(j.jsx)(m,{}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.41355a2b.chunk.js.map